{% extends "base.html" %}
{% block content %}
<div class="card card-stat mb-4">
    <div class="card-header bg-primary text-white">
        <h5><i class="fas fa-search"></i> T√åM KI·∫æM N√ÇNG CAO</h5>
    </div>
    <div class="card-body">
        <form method="GET" action="{{ url_for('admin_search') }}">
            <div class="row g-3">
                <div class="col-md-3">
                    <label>T√¨m theo:</label>
                    <select name="search_by" class="form-select">
                        <option value="M√£ SV" {% if sb=='M√£ SV' %}selected{% endif %}>M√£ SV</option>
                        <option value="H·ªç T√™n" {% if sb=='H·ªç T√™n' %}selected{% endif %}>H·ªç T√™n</option>
                        <option value="Ph√≤ng" {% if sb=='Ph√≤ng' %}selected{% endif %}>Ph√≤ng</option>
                        <option value="SƒêT" {% if sb=='SƒêT' %}selected{% endif %}>S·ªë ƒëi·ªán tho·∫°i</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label>T·ª´ kh√≥a:</label>
                    <input type="text" name="keyword" class="form-control" value="{{ k }}" placeholder="Nh·∫≠p th√¥ng tin...">
                </div>
                <div class="col-md-3">
                    <label>Tr·∫°ng th√°i ph√≤ng:</label>
                    <select name="status" class="form-select">
                        <option value="T·∫•t c·∫£" {% if st=='T·∫•t c·∫£' %}selected{% endif %}>T·∫•t c·∫£</option>
                        <option value="C√≥ ph√≤ng" {% if st=='C√≥ ph√≤ng' %}selected{% endif %}>ƒê√£ c√≥ ph√≤ng</option>
                        <option value="Ch∆∞a c√≥ ph√≤ng" {% if st=='Ch∆∞a c√≥ ph√≤ng' %}selected{% endif %}>Ch∆∞a c√≥ ph√≤ng</option>
                    </select>
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary w-100">üîç T√¨m Ki·∫øm</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="card card-stat">
    <div class="card-body">
        <h6 class="text-success fst-italic">T√¨m th·∫•y {{ results|length }} k·∫øt qu·∫£</h6>
        <table class="table table-bordered table-hover mt-3">
            <thead class="table-light">
                <tr>
                    <th>M√£ SV</th>
                    <th>H·ªç T√™n</th>
                    <th>Ph√≤ng</th>
                    <th>SƒêT</th>
                    <th>ƒê·ªãa Ch·ªâ</th>
                    <th>Hƒê Ch∆∞a TT</th>
                </tr>
            </thead>
            <tbody>
                {% for row in results %}
                <tr>
                    <td><b>{{ row[0] }}</b></td>
                    <td>{{ row[1] }}</td>
                    <td><span class="badge bg-info text-dark">{{ row[2] if row[2] else '---' }}</span></td>
                    <td>{{ row[4] }}</td>
                    <td>{{ row[3] }}</td>
                    <td>
                        {% if row[5] > 0 %}
                            <span class="badge bg-danger">{{ row[5] }} h√≥a ƒë∆°n</span>
                        {% else %}
                            <span class="badge bg-success">S·∫°ch</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
<div class="mt-3 text-end">
    <a href="{{ url_for('export_excel') }}" class="btn btn-success"><i class="fas fa-file-excel"></i> Xu·∫•t To√†n B·ªô Excel</a>
</div>
{% endblock %}